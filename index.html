<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema SST Profissional</title>

<!-- PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{font-family:Arial;margin:0;padding:15px;background:#f4f6f8;}
header{text-align:center;padding:20px;background:#003366;color:#fff;border-radius:12px;}
h1{margin:0;font-size:22px;}
.btn{
  width:100%;padding:14px;margin:10px 0;
  border:none;border-radius:12px;
  background:#0059b3;color:white;
  font-size:16px;font-weight:bold;
}
.save{background:green;}
.pdf{background:darkred;}
.whats{background:#25D366;}
.back{background:gray;}

section{
  display:none;
  background:white;
  padding:15px;
  margin-top:15px;
  border-radius:12px;
}

input,textarea,select{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
  margin-top:6px;
}

canvas{
  width:100%;
  height:160px;
  border:2px solid black;
  border-radius:10px;
  background:white;
  touch-action:none;
}
small{color:#444;}
</style>
</head>

<body>

<header>
<h1>Sistema Ãšnico SST</h1>
<p><b>FREIBERGER & FERNANDES â€“ Engenharia</b></p>
<p>PadrÃ£o FiscalizaÃ§Ã£o Oficial</p>
</header>

<!-- MENU -->
<section id="menu" style="display:block;">
<button class="btn" onclick="abrir('nr35')">ðŸ“‹ NR35 â€“ Trabalho em Altura</button>
<button class="btn" onclick="abrir('nr18')">ðŸ¦º NR18 â€“ Checklist Obra</button>
<button class="btn" onclick="abrir('historico')">ðŸ“‚ HistÃ³rico</button>
</section>

<!-- NR35 -->
<section id="nr35">
<h2>ðŸ“‹ NR35 â€“ AutorizaÃ§Ã£o Trabalho em Altura</h2>

<label>Local da Obra:</label>
<input id="local35">

<label>ResponsÃ¡vel Empresa:</label>
<input id="empresa35">

<label>Engenheiro ResponsÃ¡vel:</label>
<input id="eng35" value="Eng. Jadison Fernandes">

<hr>

<h3>Trabalhador</h3>

<label>Nome:</label>
<input id="nome1">

<label>CPF (obrigatÃ³rio):</label>
<input id="cpf1" placeholder="Digite CPF">

<h3>Assinatura Digital</h3>
<canvas id="canvas1"></canvas>
<button class="btn back" onclick="limparAss()">Limpar Assinatura</button>

<hr>

<button class="btn save" onclick="salvarNR35()">ðŸ’¾ Salvar NR35</button>
<button class="btn pdf" onclick="gerarPDF_NR35()">ðŸ“„ Gerar PDF Oficial NR35</button>

<button class="btn whats" onclick="enviarWhats()">ðŸ“² Enviar WhatsApp Engenheiro</button>

<button class="btn back" onclick="abrir('menu')">â¬… Voltar</button>
</section>

<!-- NR18 -->
<section id="nr18">
<h2>ðŸ¦º NR18 â€“ Checklist FiscalizaÃ§Ã£o</h2>

<label>Obra:</label>
<input id="obra18">

<label>ResponsÃ¡vel:</label>
<input id="resp18">

<hr>

<h3>EPI</h3>
<select id="epi1"><option>SIM</option><option>NÃƒO</option></select> Capacete<br><br>
<select id="epi2"><option>SIM</option><option>NÃƒO</option></select> Botina<br><br>
<select id="epi3"><option>SIM</option><option>NÃƒO</option></select> Luvas<br><br>
<select id="epi4"><option>SIM</option><option>NÃƒO</option></select> Ã“culos<br><br>

<h3>ConclusÃ£o</h3>
<textarea id="obs18" placeholder="ObservaÃ§Ãµes"></textarea>

<button class="btn save" onclick="salvarNR18()">ðŸ’¾ Salvar NR18</button>
<button class="btn pdf" onclick="gerarPDF_NR18()">ðŸ“„ Gerar PDF Oficial NR18</button>

<button class="btn back" onclick="abrir('menu')">â¬… Voltar</button>
</section>

<!-- HISTÃ“RICO -->
<section id="historico">
<h2>ðŸ“‚ HistÃ³rico</h2>
<div id="lista"></div>
<button class="btn back" onclick="abrir('menu')">â¬… Voltar</button>
</section>

<script>
/* MENU */
function abrir(id){
  document.querySelectorAll("section").forEach(sec=>sec.style.display="none");
  document.getElementById(id).style.display="block";
  if(id==="historico") carregarHistorico();
}

/* ASSINATURA */
let canvas=document.getElementById("canvas1");
let ctx=canvas.getContext("2d");
canvas.width=canvas.offsetWidth;
canvas.height=160;

let desenhando=false;
canvas.addEventListener("pointerdown",e=>{
  desenhando=true;
  ctx.beginPath();
  ctx.moveTo(e.offsetX,e.offsetY);
});
canvas.addEventListener("pointermove",e=>{
  if(!desenhando) return;
  ctx.lineTo(e.offsetX,e.offsetY);
  ctx.stroke();
});
canvas.addEventListener("pointerup",()=>desenhando=false);

function limparAss(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
}

/* SALVAR */
function salvarNR35(){
  if(document.getElementById("cpf1").value.trim()===""){
    alert("âš ï¸ CPF obrigatÃ³rio!");
    return;
  }
  let dados=JSON.parse(localStorage.getItem("sst")||"[]");
  dados.push({tipo:"NR35",data:new Date().toLocaleString()});
  localStorage.setItem("sst",JSON.stringify(dados));
  alert("âœ… NR35 salva!");
}

function salvarNR18(){
  let dados=JSON.parse(localStorage.getItem("sst")||"[]");
  dados.push({tipo:"NR18",data:new Date().toLocaleString()});
  localStorage.setItem("sst",JSON.stringify(dados));
  alert("âœ… NR18 salva!");
}

/* HISTÃ“RICO */
function carregarHistorico(){
  let dados=JSON.parse(localStorage.getItem("sst")||"[]");
  lista.innerHTML=dados.map(r=>`<p>âœ… ${r.tipo} â€“ ${r.data}</p>`).join("");
}

/* PDF NR35 */
function gerarPDF_NR35(){
  const { jsPDF } = window.jspdf;
  let doc=new jsPDF();

  doc.text("NR35 â€“ AutorizaÃ§Ã£o Trabalho em Altura",10,10);
  doc.text("Local: "+local35.value,10,20);
  doc.text("Trabalhador: "+nome1.value,10,30);
  doc.text("CPF: "+cpf1.value,10,40);

  let img=canvas.toDataURL("image/png");
  doc.text("Assinatura:",10,55);
  doc.addImage(img,"PNG",10,60,80,30);

  doc.save("NR35_Oficial.pdf");
}

/* PDF NR18 */
function gerarPDF_NR18(){
  const { jsPDF } = window.jspdf;
  let doc=new jsPDF();

  doc.text("NR18 â€“ Checklist FiscalizaÃ§Ã£o",10,10);
  doc.text("Obra: "+obra18.value,10,20);
  doc.text("ResponsÃ¡vel: "+resp18.value,10,30);

  doc.text("Capacete: "+epi1.value,10,45);
  doc.text("Botina: "+epi2.value,10,55);

  doc.text("ObservaÃ§Ãµes:",10,70);
  doc.text(obs18.value,10,80);

  doc.save("NR18_Oficial.pdf");
}

/* WHATSAPP */
function enviarWhats(){
  let msg="NR35 preenchida â€“ Local: "+local35.value+
          " Trabalhador: "+nome1.value+
          " CPF: "+cpf1.value;
  window.open("https://wa.me/5547988837699?text="+encodeURIComponent(msg));
}
</script>

</body>
</html>
