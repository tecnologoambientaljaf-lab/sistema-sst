<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Ãšnico SST</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{font-family:Arial;margin:0;padding:15px;background:#f4f6f8;}
header{text-align:center;padding:20px;background:#003366;color:#fff;border-radius:12px;}
h1{margin:0;font-size:22px;}

.btn{
  width:100%;padding:14px;margin:10px 0;
  border:none;border-radius:12px;
  font-size:16px;font-weight:bold;
  color:white;
}
.save{background:green;}
.pdf{background:darkred;}
.whats{background:#25D366;}
.back{background:gray;}

section{
  display:none;
  background:white;
  padding:15px;
  margin-top:15px;
  border-radius:12px;
}

input,textarea,select{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
  margin-top:6px;
}

canvas{
  width:100%;
  height:140px;
  border:2px solid black;
  border-radius:10px;
  background:white;
  touch-action:none;
}

hr{margin:20px 0;}
h3{margin-top:25px;}
</style>
</head>

<body>

<header>
<h1>Sistema Ãšnico SST</h1>
<p><b>FREIBERGER & FERNANDES â€“ Engenharia</b></p>
<p>PadrÃ£o FiscalizaÃ§Ã£o Oficial</p>
</header>

<!-- MENU -->
<section id="menu" style="display:block;">
<button class="btn pdf" onclick="abrir('nr35')">ðŸ“‹ NR35 â€“ Trabalho em Altura</button>
<button class="btn save" onclick="abrir('nr18')">ðŸ¦º NR18 â€“ Checklist FiscalizaÃ§Ã£o</button>
</section>

<!-- ======================= NR35 ======================= -->
<section id="nr35">
<h2>ðŸ“‹ NR35 â€“ AutorizaÃ§Ã£o Trabalho em Altura</h2>

<label>Local da Obra:</label>
<input id="local35">

<label>ResponsÃ¡vel Empresa:</label>
<input id="empresa35">

<label>Engenheiro ResponsÃ¡vel:</label>
<input id="eng35" value="Eng. Jadison Fernandes">

<hr>

<h3>CapacitaÃ§Ã£o / Riscos Gerais</h3>

<div id="riscos35"></div>

<hr>

<h3>Trabalhador</h3>

<label>Nome:</label>
<input id="nome35">

<label>CPF (obrigatÃ³rio):</label>
<input id="cpf35" placeholder="Digite CPF">

<h3>Assinatura Digital</h3>
<canvas id="assinatura35"></canvas>
<button class="btn back" onclick="limparAssinatura()">Limpar Assinatura</button>

<hr>

<button class="btn save" onclick="gerarPDF_NR35()">ðŸ“„ Gerar PDF Oficial NR35</button>
<button class="btn whats" onclick="enviarWhats()">ðŸ“² Enviar WhatsApp Engenheiro</button>
<button class="btn back" onclick="abrir('menu')">â¬… Voltar</button>
</section>

<!-- ======================= NR18 ======================= -->
<section id="nr18">
<h2>ðŸ¦º NR18 â€“ Checklist FiscalizaÃ§Ã£o</h2>

<label>Obra:</label>
<input id="obra18">

<label>ResponsÃ¡vel:</label>
<input id="resp18">

<hr>

<h3>CapacitaÃ§Ã£o / Riscos Gerais</h3>
<div id="riscos18"></div>

<hr>

<h3>EPI</h3>
<label>Capacete:
<select id="epi1"><option>SIM</option><option>NÃƒO</option></select></label><br>

<label>Botina:
<select id="epi2"><option>SIM</option><option>NÃƒO</option></select></label><br>

<label>Luvas:
<select id="epi3"><option>SIM</option><option>NÃƒO</option></select></label><br>

<label>Ã“culos:
<select id="epi4"><option>SIM</option><option>NÃƒO</option></select></label><br>

<hr>

<h3>ConclusÃ£o</h3>
<textarea id="obs18" placeholder="ObservaÃ§Ãµes"></textarea>

<button class="btn pdf" onclick="gerarPDF_NR18()">ðŸ“„ Gerar PDF Oficial NR18</button>
<button class="btn back" onclick="abrir('menu')">â¬… Voltar</button>
</section>

<script>
/* ================= MENU ================= */
function abrir(id){
  document.querySelectorAll("section").forEach(sec=>sec.style.display="none");
  document.getElementById(id).style.display="block";
}

/* ================= CHECKLIST RISCOS ================= */
const itensRisco=[
 "FuncionÃ¡rio treinado na atividade?",
 "Exame mÃ©dico OK?",
 "Risco de contato com partes energizadas?",
 "Tempo seco e sem vento forte?",
 "Existe risco de queda de objetos?",
 "Ãrea de trabalho isolada?",
 "Local seguro para fixaÃ§Ã£o do cinto?"
];

function montarRiscos(id){
  let html="";
  itensRisco.forEach((t,i)=>{
    html+=`
    <label>${t}
      <select id="${id}_${i}">
        <option>SIM</option>
        <option>NÃƒO</option>
        <option>N/A</option>
      </select>
    </label><br><br>`;
  });
  document.getElementById(id).innerHTML=html;
}

montarRiscos("riscos35");
montarRiscos("riscos18");

/* ================= ASSINATURA ================= */
let canvas=document.getElementById("assinatura35");
let ctx=canvas.getContext("2d");

canvas.width=canvas.offsetWidth;
canvas.height=140;

let desenhando=false;

canvas.addEventListener("pointerdown",e=>{
  desenhando=true;
  ctx.beginPath();
  ctx.moveTo(e.offsetX,e.offsetY);
});

canvas.addEventListener("pointermove",e=>{
  if(!desenhando) return;
  ctx.lineTo(e.offsetX,e.offsetY);
  ctx.stroke();
});

canvas.addEventListener("pointerup",()=>desenhando=false);

function limparAssinatura(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
}

/* ================= PDF NR35 ================= */
function gerarPDF_NR35(){

  if(cpf35.value.trim()==""){
    alert("âš ï¸ CPF obrigatÃ³rio!");
    return;
  }

  const { jsPDF } = window.jspdf;
  let doc=new jsPDF();

  doc.setFontSize(14);
  doc.text("NR35 â€“ AUTORIZAÃ‡ÃƒO TRABALHO EM ALTURA",10,15);

  doc.setFontSize(11);
  doc.text("Local: "+local35.value,10,30);
  doc.text("Empresa: "+empresa35.value,10,38);

  let y=55;
  doc.text("CapacitaÃ§Ã£o / Riscos Gerais:",10,y);

  y+=10;
  itensRisco.forEach((t,i)=>{
    let val=document.getElementById("riscos35_"+i).value;
    doc.text("- "+t+"  ["+val+"]",10,y);
    y+=7;
  });

  y+=10;
  doc.text("Trabalhador: "+nome35.value,10,y);
  y+=7;
  doc.text("CPF: "+cpf35.value,10,y);

  y+=10;
  doc.text("Assinatura:",10,y);

  let img=canvas.toDataURL("image/png");
  doc.addImage(img,"PNG",10,y+5,80,25);

  doc.save("NR35_Oficial.pdf");
}

/* ================= PDF NR18 ================= */
function gerarPDF_NR18(){
  const { jsPDF } = window.jspdf;
  let doc=new jsPDF();

  doc.setFontSize(14);
  doc.text("NR18 â€“ CHECKLIST FISCALIZAÃ‡ÃƒO",10,15);

  doc.setFontSize(11);
  doc.text("Obra: "+obra18.value,10,30);
  doc.text("ResponsÃ¡vel: "+resp18.value,10,38);

  let y=55;
  doc.text("CapacitaÃ§Ã£o / Riscos Gerais:",10,y);

  y+=10;
  itensRisco.forEach((t,i)=>{
    let val=document.getElementById("riscos18_"+i).value;
    doc.text("- "+t+"  ["+val+"]",10,y);
    y+=7;
  });

  y+=10;
  doc.text("EPI:",10,y);

  y+=7;
  doc.text("Capacete: "+epi1.value,10,y);
  y+=7;
  doc.text("Botina: "+epi2.value,10,y);
  y+=7;
  doc.text("Luvas: "+epi3.value,10,y);
  y+=7;
  doc.text("Ã“culos: "+epi4.value,10,y);

  y+=10;
  doc.text("ObservaÃ§Ãµes:",10,y);
  y+=7;
  doc.text(obs18.value,10,y);

  doc.save("NR18_Oficial.pdf");
}

/* ================= WHATSAPP ================= */
function enviarWhats(){
  let msg="NR35 preenchida - Local: "+local35.value+
          " Trabalhador: "+nome35.value+
          " CPF: "+cpf35.value;
  window.open("https://wa.me/5547988837699?text="+encodeURIComponent(msg));
}
</script>

</body>
</html>
